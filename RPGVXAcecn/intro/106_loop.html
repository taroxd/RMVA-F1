<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<meta http-equiv="Content-Style-Type" content="text/css">
<title>ループ</title>
<link href="../style.css" type="text/css" rel="stylesheet">
</head>
<body>

<h1>ループ</h1>
<ul>
<li><a href="#while">while 〜 end</a></li>
<li><a href="#range">範囲オブジェクト</a></li>
<li><a href="#for">for 〜 in 〜 end</a></li>
<li><a href="#loop">loop do 〜 end</a></li>
<li><a href="#break">break</a></li>
<li><a href="#next">next</a></li>
<li><a href="#nested">二重ループ</a></li>
</ul>

<p>特定の処理を繰り返し行いたいときに使うの
が<strong>ループ</strong>です。</p>


<h2><a name="while">while 〜 end</a></h2>
<p>特定の条件が満たされている間ループさせたい場合、while を使います。</p>
<pre>
a = 0               # 変数 a に 0 を代入する。
i = 1               # 変数 i に 1 を代入する。

while i &lt;= 5        # 変数 i が 5 以下の間ループさせ、
  a += i            #   変数 a にそれぞれの i の値を加算する。
  i += 1            #   変数 i の値を 1 増やす。
end                 # ループ終了。

p a                 # 計算結果を表示する。
</pre>
<p>これは 1 から 5 までの数の合計を求めるプログラムです。
ここで、変数 i は 1 から 5 までの数値を作り出すために用いられています。
もちろん変数名は i でなくても構いませんが、一般にループの処理用変数としては
i、j、k といった名前がよく使われます。</p>
<p>さて、このプログラムで意味が把握しづらいのは i += 1 という行でしょう。
この行がなければ i がいつまでも 1 のままなので i &lt;= 5 という条件がずっと
満たされ続けることになり、無限ループとなってしまいます。そのため、ここでは
毎回 i に 1 を足していくことで 1、2、3 …と数値を変化させているのです。</p>
<p>変数 a および i の値の変化を表にすると、以下のようになります。</p>
<table border="1" cellspacing="0" cellpadding="2">
<tr>
 <th>ループ</th><th>a の値</th><th>i の値</th>
</tr><tr>
 <td>初期状態</td><td>0</td><td>1</td>
</tr><tr>
 <td>1 周後</td><td>1</td><td>2</td>
</tr><tr>
 <td>2 周後</td><td>3</td><td>3</td>
</tr><tr>
 <td>3 周後</td><td>6</td><td>4</td>
</tr><tr>
 <td>4 周後</td><td>10</td><td>5</td>
</tr><tr>
 <td>5 周後</td><td><strong>15</strong></td><td>6</td>
</tr>
</tr></table>
<p>ループを 5 周した時点で、a の中では 1+2+3+4+5 という計算がなされた
ことになり、i の値が 5 を超えるために end で繰り返しが終了します。</p>
<p>そして、p で最終的な a の値を表示することになり、答の 15 という数値が表示
されるというわけです。</p>


<h2><a name="range">範囲オブジェクト</a></h2>
<p>数値の範囲、たとえば「1 から 5 まで」というような概念を表すもの
を<strong>範囲オブジェクト</strong>と呼びます。</p>
<pre>
1..5
</pre>
<p>上の式は「1 から 5 まで」を表しています。このように .. という
演算子を使用することで、範囲オブジェクトを作成することができます。</p>
<p>また、... という演算子を使用することもできます。</p>
<pre>
1...5
</pre>
<p>.. との違いは「終端を含まない」ということです。ですから、
この場合は実際には「1 から 4 まで」を表すことになります。</p>


<h2><a name="for">for 〜 in 〜 end</a></h2>
<p>範囲オブジェクトで表された範囲内でループさせたい場合は for を
使います。</p>
<pre>
a = 0               # 変数 a に 0 を代入する。

for i in 1..5       # 変数 i を 1 から 5 までの範囲で変化させ、
  a += i            #   変数 a にそれぞれの i の値を加算する。
end                 # ループ終了。

p a                 # 計算結果を表示する。
</pre>
<p>これは while を使ったプログラムと全く同じ 1 から 5 までの数の合計を
求めるプログラムですが、while を使った場合よりスマートになっているのが
わかるでしょうか。while では変数 i に 1 を加算していくことで 1 から 5
までの範囲を表現していましたが、for では変数 i に対して「1 から 5 までの
範囲」の数を順に代入していくことで表しています。見た目の違いはあります
が、実際には、全く同じ処理が行なわれているのです。</p>
<p>Ruby にはいろいろな文法があり、ループひとつとってもさまざまな方法が
存在します。そういった文法のほとんどは、この例のように「より簡単に書く
ため」にあると考えてください。実際、条件分岐とループさえ理解していれば、
ほとんどのロジックは表現できてしまうのです。</p>


<h2><a name="loop">loop do 〜 end</a></h2>
<p>繰り返す回数や条件を指定しないでループさせたい場合、すなわち無限ループを
作りたい場合は loop を使用します。これは while や for とは少し性質が異なり
ますが、通常、その違いを特に意識する必要はありません。</p>
<pre>
i = 0               # 変数 i に 0 を代入する。

loop do             # ループ開始。
  i += 1            #   変数 i の値を 1 増やす。
  p i               #   変数 i の値を表示する。
end                 # ループ終了。
</pre>
<p>これは「i の値を 1 ずつ増やしながら、その値を表示する」というプロ
グラムですが、終了条件がありません。これを実行すると、1、2、3 …と
果てしなく表示が続きます。</p>


<h2><a name="break">break</a></h2>
<p>ループを途中で中断したい場合には break という命令を使用します。</p>
<pre>
i = 0               # 変数 i に 0 を代入する。

loop do             # ループ開始。
  i += 1            #   変数 i の値を 1 増やす。
  if i == 5         #   もし変数 i の値が 5 なら、
    break           #     ループを中断する。
  end               #   条件分岐終了。
  p i               #   変数 i の値を表示する。
end                 # ループ終了。
</pre>
<p>先ほどのプログラムに「i が 5 になったら中断しなさい」という条件を加え
ました。これを実行すると、1、2、3、4 と表示されてそこで終了となります。</p>
<p>break は、while や for など、他の方法で作成したループでも使うことが
できます。</p>


<h2><a name="next">next</a></h2>
<p>ループを中断せずに、次の繰り返しに処理を移すときには next という命令を
使用します。</p>
<pre>
for i in 1..5       # 変数 i を 1 から 5 までの範囲で変化させ、
  if i == 3         #   もし変数 i の値が 3 なら、
    next            #     次の繰り返しへ。
  end               #   条件分岐終了。
  p i               #   変数 i の値を表示する。
end                 # ループ終了。
</pre>
<p>これを実行すると、1、2、4、5 と表示されます。</p>


<h2><a name="nested">二重ループ</a></h2>
<p>条件分岐やループのような制御構造は、入れ子にして使うことが
可能です。たとえば i、j という 2 種類の変数を使って二重ループを
作るには、次のように記述できます。</p>
<pre>
for i in 1..3               # 変数 i を 1 から 3 までの範囲で変化させる。
  for j in 1..4             #   変数 j を 1 から 4 までの範囲で変化させる。
    print &quot;(#{i},#{j}) &quot;    #     (i,j) を表示する。
  end                       #   内側のループ終了。
  print "\n"                #   改行。
end                         # 外側のループ終了。
</pre>
<p>なお、空白文字は処理の内容に影響を与えませんが、構造がわかりやすく
なるように 2 文字分の字下げを使用するのが一般的です。</p>


<h6></h6>

</body>
</html>
